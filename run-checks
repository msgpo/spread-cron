#!/bin/sh
set -e

mkdir -p bin
( cd bin &&  wget https://niemeyer.s3.amazonaws.com/spread-amd64.tar.gz -O spread.tar.gz && tar xzvf spread.tar.gz )
git clone https://github.com/snapcore/snapd target

cd target

export SPREAD_NEW_CORE_CHANNEL=edge

# Classic -> 16.04 18.04 20.04
# Core -> 16.04 18.04
# Core20 -> 20.04
# Manual -> 19.10 20.04


../bin/spread -v google:tests/nightly/ google-nested:ubuntu-16.04-64:tests/nested/classic/ google-nested:ubuntu-18.04-64:tests/nested/classic/ google-nested:ubuntu-20.04-64:tests/nested/classic/ google-nested:ubuntu-16.04-64:tests/nested/core/ google-nested:ubuntu-18.04-64:tests/nested/core/ google-nested:ubuntu-20.04-64:tests/nested/core20/ google-nested:ubuntu-19.10-64:tests/nested/manual/ google-nested:ubuntu-20.04-64:tests/nested/manual/
